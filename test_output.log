============================= test session starts ==============================
platform linux -- Python 3.12.7, pytest-8.3.4, pluggy-1.5.0 -- /home/d/Desktop/AAT/adaptive-attention-tiling-v2/venv/bin/python
cachedir: .pytest_cache
rootdir: /home/d/Desktop/AAT/adaptive-attention-tiling-v2/tests
configfile: pytest.ini
collecting ... collected 1 item

tests/test_neural/test_attention/test_pattern/test_stability.py::test_stability_analysis FAILED [100%]2024-12-10 21:19:14,898 - tests.conftest - WARNING - Test session finished with 1 passed, 0 failed


=================================== FAILURES ===================================
___________________________ test_stability_analysis ____________________________
tests/test_neural/test_attention/test_pattern/test_stability.py:19: in test_stability_analysis
    metrics = pattern_system.stability_analysis(pattern, perturbation)
        grid_size  = 32
        pattern    = tensor([[[[ 1.1865,  0.5991, -0.1741,  ...,  0.4269, -0.6404,  0.3587],
          [-1.2439, -0.7859,  0.7047,  ..., -0.6008,  0.4147, -0.3637],
          [-1.7788,  0.5334, -0.5454,  ...,  0.3715,  2.0647,  1.2874],
          ...,
          [-1.3812, -1.5355, -0.1494,  ..., -0.1187,  0.2858,  0.0534],
          [ 0.5922,  0.0136,  1.7070,  ..., -0.9294,  0.7735,  1.2828],
          [-0.5459,  0.3010,  0.7998,  ..., -1.2156, -0.4353,  0.9016]],

         [[-0.6896, -1.1987,  0.0175,  ...,  1.4037,  0.3542,  0.2270],
          [ 0.4030,  0.3490, -0.1175,  ...,  1.0901,  0.4133, -0.2527],
          [-0.4985, -0.1267,  1.3951,  ..., -0.3615, -1.0839,  0.3308],
          ...,
          [-0.7649,  0.5622,  0.8852,  ..., -0.2971, -1.7650,  0.9797],
          [ 0.2924, -0.7154,  0.6736,  ...,  0.7080,  0.5189,  1.0146],
          [-1.0098, -1.7477,  0.5455,  ..., -0.4209, -1.3198, -0.6368]]]])
        pattern_system = <src.neural.attention.pattern.dynamics.PatternDynamics object at 0x7820d1fe2e10>
        perturbation = tensor([[[[-0.1412, -0.1128, -0.0590,  ..., -0.0980, -0.0219, -0.1028],
          [ 0.0475,  0.0123,  0.1120,  ..., -0.0836, -0.0238, -0.1565],
          [-0.2461, -0.1837, -0.0255,  ...,  0.0655,  0.1100, -0.1388],
          ...,
          [ 0.1041, -0.0106,  0.2204,  ..., -0.0478,  0.0517, -0.1194],
          [ 0.0376, -0.0490, -0.1624,  ...,  0.1077,  0.0036, -0.0220],
          [ 0.1638, -0.0542, -0.0182,  ..., -0.1861,  0.0159,  0.1524]],

         [[-0.1241,  0.1287, -0.0667,  ...,  0.0769,  0.0067, -0.0486],
          [-0.0832,  0.0228, -0.0788,  ...,  0.0907,  0.0818,  0.2013],
          [ 0.0499, -0.1387,  0.0423,  ..., -0.0618,  0.0202, -0.0969],
          ...,
          [ 0.0230, -0.0964, -0.1010,  ..., -0.0352, -0.0630,  0.1286],
          [ 0.0803, -0.0615,  0.0006,  ...,  0.1843,  0.1445,  0.1620],
          [-0.1480, -0.0505, -0.1625,  ...,  0.2155, -0.0728,  0.1004]]]])
src/neural/attention/pattern/dynamics.py:260: in stability_analysis
    return self.stability.analyze_stability(fixed_point, perturbation)
        fixed_point = tensor([[[[ 1.1865,  0.5991, -0.1741,  ...,  0.4269, -0.6404,  0.3587],
          [-1.2439, -0.7859,  0.7047,  ..., -0.6008,  0.4147, -0.3637],
          [-1.7788,  0.5334, -0.5454,  ...,  0.3715,  2.0647,  1.2874],
          ...,
          [-1.3812, -1.5355, -0.1494,  ..., -0.1187,  0.2858,  0.0534],
          [ 0.5922,  0.0136,  1.7070,  ..., -0.9294,  0.7735,  1.2828],
          [-0.5459,  0.3010,  0.7998,  ..., -1.2156, -0.4353,  0.9016]],

         [[-0.6896, -1.1987,  0.0175,  ...,  1.4037,  0.3542,  0.2270],
          [ 0.4030,  0.3490, -0.1175,  ...,  1.0901,  0.4133, -0.2527],
          [-0.4985, -0.1267,  1.3951,  ..., -0.3615, -1.0839,  0.3308],
          ...,
          [-0.7649,  0.5622,  0.8852,  ..., -0.2971, -1.7650,  0.9797],
          [ 0.2924, -0.7154,  0.6736,  ...,  0.7080,  0.5189,  1.0146],
          [-1.0098, -1.7477,  0.5455,  ..., -0.4209, -1.3198, -0.6368]]]])
        perturbation = tensor([[[[-0.1412, -0.1128, -0.0590,  ..., -0.0980, -0.0219, -0.1028],
          [ 0.0475,  0.0123,  0.1120,  ..., -0.0836, -0.0238, -0.1565],
          [-0.2461, -0.1837, -0.0255,  ...,  0.0655,  0.1100, -0.1388],
          ...,
          [ 0.1041, -0.0106,  0.2204,  ..., -0.0478,  0.0517, -0.1194],
          [ 0.0376, -0.0490, -0.1624,  ...,  0.1077,  0.0036, -0.0220],
          [ 0.1638, -0.0542, -0.0182,  ..., -0.1861,  0.0159,  0.1524]],

         [[-0.1241,  0.1287, -0.0667,  ...,  0.0769,  0.0067, -0.0486],
          [-0.0832,  0.0228, -0.0788,  ...,  0.0907,  0.0818,  0.2013],
          [ 0.0499, -0.1387,  0.0423,  ..., -0.0618,  0.0202, -0.0969],
          ...,
          [ 0.0230, -0.0964, -0.1010,  ..., -0.0352, -0.0630,  0.1286],
          [ 0.0803, -0.0615,  0.0006,  ...,  0.1843,  0.1445,  0.1620],
          [-0.1480, -0.0505, -0.1625,  ...,  0.2155, -0.0728,  0.1004]]]])
        self       = <src.neural.attention.pattern.dynamics.PatternDynamics object at 0x7820d1fe2e10>
src/neural/attention/pattern/stability.py:70: in analyze_stability
    return StabilityMetrics(
E   TypeError: StabilityMetrics.__init__() missing 2 required positional arguments: 'lyapunov_spectrum' and 'structural_stability'
        fixed_point = tensor([[[[ 1.1865,  0.5991, -0.1741,  ...,  0.4269, -0.6404,  0.3587],
          [-1.2439, -0.7859,  0.7047,  ..., -0.6008,  0.4147, -0.3637],
          [-1.7788,  0.5334, -0.5454,  ...,  0.3715,  2.0647,  1.2874],
          ...,
          [-1.3812, -1.5355, -0.1494,  ..., -0.1187,  0.2858,  0.0534],
          [ 0.5922,  0.0136,  1.7070,  ..., -0.9294,  0.7735,  1.2828],
          [-0.5459,  0.3010,  0.7998,  ..., -1.2156, -0.4353,  0.9016]],

         [[-0.6896, -1.1987,  0.0175,  ...,  1.4037,  0.3542,  0.2270],
          [ 0.4030,  0.3490, -0.1175,  ...,  1.0901,  0.4133, -0.2527],
          [-0.4985, -0.1267,  1.3951,  ..., -0.3615, -1.0839,  0.3308],
          ...,
          [-0.7649,  0.5622,  0.8852,  ..., -0.2971, -1.7650,  0.9797],
          [ 0.2924, -0.7154,  0.6736,  ...,  0.7080,  0.5189,  1.0146],
          [-1.0098, -1.7477,  0.5455,  ..., -0.4209, -1.3198, -0.6368]]]],
       dtype=torch.float64)
        linear_stability = tensor([0.0583], dtype=torch.float64, grad_fn=<MaxBackward0>)
        nonlinear_stability = tensor([-0.0822], dtype=torch.float64, grad_fn=<SelectBackward0>)
        perturbation = tensor([[[[-0.1412, -0.1128, -0.0590,  ..., -0.0980, -0.0219, -0.1028],
          [ 0.0475,  0.0123,  0.1120,  ..., -0.0836, -0.0238, -0.1565],
          [-0.2461, -0.1837, -0.0255,  ...,  0.0655,  0.1100, -0.1388],
          ...,
          [ 0.1041, -0.0106,  0.2204,  ..., -0.0478,  0.0517, -0.1194],
          [ 0.0376, -0.0490, -0.1624,  ...,  0.1077,  0.0036, -0.0220],
          [ 0.1638, -0.0542, -0.0182,  ..., -0.1861,  0.0159,  0.1524]],

         [[-0.1241,  0.1287, -0.0667,  ...,  0.0769,  0.0067, -0.0486],
          [-0.0832,  0.0228, -0.0788,  ...,  0.0907,  0.0818,  0.2013],
          [ 0.0499, -0.1387,  0.0423,  ..., -0.0618,  0.0202, -0.0969],
          ...,
          [ 0.0230, -0.0964, -0.1010,  ..., -0.0352, -0.0630,  0.1286],
          [ 0.0803, -0.0615,  0.0006,  ...,  0.1843,  0.1445,  0.1620],
          [-0.1480, -0.0505, -0.1625,  ...,  0.2155, -0.0728,  0.1004]]]],
       dtype=torch.float64)
        self       = <src.neural.attention.pattern.stability.StabilityAnalyzer object at 0x7820d1b5d520>

---------------------------- live log sessionfinish ----------------------------
2024-12-10 21:19:14 [ WARNING] Test session finished with 1 passed, 0 failed (conftest.py:219)
=========================== short test summary info ============================
FAILED tests/test_neural/test_attention/test_pattern/test_stability.py::test_stability_analysis - TypeError: StabilityMetrics.__init__() missing 2 required positional arguments: 'lyapunov_spectrum' and 'structural_stability'
============================== 1 failed in 0.09s ===============================
